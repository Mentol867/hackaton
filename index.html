<!DOCTYPE html>
<html lang="uk">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Університетська платформа оголошень</title>
    <link rel="stylesheet" href="styles/main.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
</head>
<body>
    <header class="header">
        <div class="container">
            <div class="logo">
                <i class="fas fa-university"></i>
                <h1>UniConnect</h1>
            </div>
            <nav class="nav">
                <a href="index.html" class="nav-link active">Головна</a>
                <a href="announcements.html" class="nav-link">Оголошення</a>
                <a href="profile.html" class="nav-link">Профіль</a>
                <a href="login.html" class="nav-link" id="loginLink">Вхід</a>
                <a href="register.html" class="nav-link" id="registerLink">Реєстрація</a>
                <button class="nav-link" id="logoutBtn" style="display: none; background: none; border: none; color: inherit; cursor: pointer;">
                    <i class="fas fa-sign-out-alt"></i> Вихід
                </button>
                <button class="theme-toggle" id="themeToggle">
                    <i class="fas fa-moon"></i>
                </button>
            </nav>
        </div>
    </header>

    <main class="main">
        <div class="container">
            <div class="hero">
                <h2>Платформа для співпраці університетів та компаній</h2>
                <p>Знаходьте можливості для проведення лекцій, семінарів та інших освітніх заходів</p>
                <div class="">
                <!-- <div class="hero-buttons"> -->
                    <script>

                    </script>
                    <a href="register.html" id="connect" class="btn btn-primary">Приєднатися</a>
                    <a href="announcements.html" class="btn btn-secondary">Переглянути оголошення</a>
                </div>
            </div>

            <div class="content-wrapper">
                <aside class="sidebar">
             

                    <div class="sidebar-section">
                        <h3>Статистика</h3>
                        <div class="stats">
                            <div class="stat-item">
                                <span class="stat-number" id="totalAnnouncements">0</span>
                                <span class="stat-label">Оголошень</span>
                            </div>
                            <div class="stat-item">
                                <span class="stat-number" id="totalUniversities">0</span>
                                <span class="stat-label">Університетів</span>
                            </div>
                            <div class="stat-item">
                                <span class="stat-number" id="totalCompanies">0</span>
                                <span class="stat-label">Компаній</span>
                            </div>
                        </div>
                    </div>
                </aside>

                <section class="main-content">
                    <div class="section-header">
                        <h2>Останні оголошення</h2>
                        <a href="create-announcement.html" class="btn btn-primary" id="createAnnouncementBtn" style="display: none;">
                            <i class="fas fa-plus"></i> Створити оголошення
                        </a>
                    </div>
                    
                    <div class="announcements-grid" id="announcementsGrid">
                        <!-- Оголошення будуть завантажені через JavaScript -->
                    </div>

                    <div class="no-announcements" id="noAnnouncements" style="display: none;">
                        <i class="fas fa-bullhorn"></i>
                        <h3>Поки що немає оголошень</h3>
                        <p>Станьте першим, хто створить оголошення на платформі!</p>
                    </div>
                </section>
            </div>
        </div>
    </main>

    <footer class="footer">
        <div class="container">
            <p>&copy; 2025 UniConnect. Всі права захищені.</p>
        </div>
    </footer>

    <script src="scripts/data-api.js"></script>
    <script src="init-data.js"></script>
    <script src="scripts/data-api.js"></script>
    <script src="scripts/main.js"></script>
    <script src="scripts/auth.js"></script>
    <script>
        // Initialize main page functionality
        document.addEventListener('DOMContentLoaded', () => {
            // Update navigation based on authentication status
            NavigationManager.updateNavigation();
            
            // Load and display statistics
            const stats = dataManager.getStatistics();
            console.log(stats)
            // Update statistics display
            const totalAnnouncementsEl = document.getElementById('totalAnnouncements');
            const totalUniversitiesEl = document.getElementById('totalUniversities');
            const totalCompaniesEl = document.getElementById('totalCompanies');
            
            if (totalAnnouncementsEl) totalAnnouncementsEl.textContent = stats.activeAnnouncements;
            if (totalUniversitiesEl) totalUniversitiesEl.textContent = stats.totalUniversities;
            if (totalCompaniesEl) totalCompaniesEl.textContent = stats.totalCompanies;
            
            // Load recent announcements
            loadRecentAnnouncements();
        });
        
        function loadRecentAnnouncements() {
            const announcements = dataManager.getActiveAnnouncements();
            const recentAnnouncements = announcements
                .sort((a, b) => new Date(b.createdAt) - new Date(a.createdAt))
                .slice(0, 6); // Show only 6 most recent
            
            const grid = document.getElementById('announcementsGrid');
            const noAnnouncements = document.getElementById('noAnnouncements');
            
            if (recentAnnouncements.length === 0) {
                if (grid) grid.style.display = 'none';
                if (noAnnouncements) noAnnouncements.style.display = 'block';
                return;
            }
            
            if (grid) {
                grid.style.display = 'grid';
                grid.innerHTML = recentAnnouncements.map(announcement => createAnnouncementCard(announcement)).join('');
            }
            if (noAnnouncements) noAnnouncements.style.display = 'none';
        }
        
        function createAnnouncementCard(announcement) {
            const author = authManager.getUserById(announcement.authorId);
            const authorName = author ? (author.universityName || author.companyName || 'Невідомий автор') : 'Невідомий автор';
            
            return `
                <div class="announcement-card">
                    <div class="announcement-header">
                        <div class="announcement-category ${announcement.category}">
                            ${Utils.getCategoryDisplayName(announcement.category)}
                        </div>
                        ${announcement.urgent ? '<div class="urgent-badge">Терміново</div>' : ''}
                    </div>
                    <h3 class="announcement-title">
                        <a href="view-announcement.html?id=${announcement.id}">${Utils.sanitizeHtml(announcement.title)}</a>
                    </h3>
                    <p class="announcement-description">
                        ${Utils.truncateText(Utils.sanitizeHtml(announcement.description), 120)}
                    </p>
                    <div class="announcement-meta">
                        <div class="announcement-author">
                            <i class="fas fa-${announcement.organizationType === 'university' ? 'university' : 'building'}"></i>
                            ${Utils.sanitizeHtml(authorName)}
                        </div>
                        <div class="announcement-date">
                            <i class="fas fa-calendar"></i>
                            ${Utils.formatDate(announcement.createdAt)}
                        </div>
                    </div>
                    <div class="announcement-footer">
                        <div class="announcement-location">
                            <i class="fas fa-map-marker-alt"></i>
                            ${Utils.getFormatDisplayName(announcement.format)}
                        </div>
                        <div class="announcement-views">
                            <i class="fas fa-eye"></i>
                            ${announcement.viewCount || 0}
                        </div>
                    </div>
                </div>
            `;
        }
    </script>
</body>
</html>